<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Prakash Netra - Registration</title>
  <style>
    :root {
      --primary-color: #2c3e50;
      --secondary-color: #34495e;
      --accent-color: #3498db;
      --background-start: #ecf0f1;
      --background-end: #bdc3c7;
      --card-background: #ffffff;
      --text-color: #2c3e50;
      --text-muted: #7f8c8d;
      --border-color: #d5d8dc;
      --focus-color: #3498db;
      --error-color: #e74c3c;
      --success-color: #27ae60;
      --shadow-color: rgba(0, 0, 0, 0.1);
    }
    *{margin:0;padding:0;box-sizing:border-box}
    body {
      font-family:'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;
      background:linear-gradient(135deg,var(--background-start),var(--background-end));
      min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px;color:var(--text-color)
    }
    .container{max-width:500px;width:100%}
    .registration-card {
      background:var(--card-background);padding:40px;border-radius:12px;
      box-shadow:0 8px 25px var(--shadow-color);border:1px solid var(--border-color)
    }
    .card-header{text-align:center;margin-bottom:30px}
    .card-header h1{color:var(--primary-color);font-size:28px;margin-bottom:8px}
    .card-header p{color:var(--text-muted);font-size:16px}
    .registration-form{display:flex;flex-direction:column;gap:20px}
    .form-group{display:flex;flex-direction:column;gap:6px}
    label{font-weight:500;font-size:14px}
    .required::after{content:" *";color:var(--error-color)}
    input,textarea,select{
      width:100%;padding:12px 16px;border:2px solid var(--border-color);border-radius:8px;
      font-size:16px;transition:.2s
    }
    input:focus,textarea:focus,select:focus{
      border-color:var(--focus-color);outline:none;box-shadow:0 0 0 3px rgba(52,152,219,.1)
    }
    textarea{resize:vertical;min-height:80px}
    .file-upload-container{
      position:relative;border:2px dashed var(--border-color);border-radius:8px;padding:20px;text-align:center;background:#fafbfc
    }
    .file-input{position:absolute;opacity:0;width:100%;height:100%;left:0;top:0;cursor:pointer}
    .file-upload-label{display:inline-block;background:var(--accent-color);color:white;padding:10px 20px;border-radius:6px;cursor:pointer;margin-bottom:10px}
    .photo-preview-placeholder{width:80px;height:80px;margin:10px auto 0;border:2px dashed var(--border-color);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:12px;color:var(--text-muted);overflow:hidden}
    .photo-preview-placeholder img{width:100%;height:100%;object-fit:cover}
    .helper-text{font-size:12px;color:var(--text-muted)}
    .button-group{display:flex;flex-direction:column;gap:12px}
    .btn-primary{background:var(--accent-color);color:white;border:none;padding:14px;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer}
    .btn-primary:hover{background:#2980b9}
    .btn-secondary{background:transparent;color:var(--secondary-color);border:2px solid var(--border-color);padding:12px;border-radius:8px;cursor:pointer;font-weight:700;font-size:15px;text-transform:uppercase;}
    .btn-secondary:hover{background:#f2f4f6}
    .login-link{text-align:center;margin-top:24px}
    .login-link a{color:var(--accent-color);text-decoration:none}
    .password-field{position:relative}
    .password-toggle{position:absolute;right:10px;top:50%;transform:translateY(-50%);border:none;background:transparent;cursor:pointer;font-size:12px;color:var(--text-muted)}
  </style>
</head>
<body>
  <div class="container">
    <div class="registration-card">
      <div class="card-header">
        <h1>Prakash Netra </h1>
        <p>Create your government portal account</p>
      </div>

      <form class="registration-form" id="registrationForm" novalidate>
        <div class="form-group">
          <label for="firstName" class="required">First Name</label>
          <input type="text" id="firstName" name="firstName" required minlength="2" maxlength="100" placeholder="Enter your first name">
        </div>
        <div class="form-group">
          <label for="lastName" class="required">Last Name</label>
          <input type="text" id="lastName" name="lastName" required minlength="2" maxlength="100" placeholder="Enter your last name">
        </div>

        <!-- ✅ Role Dropdown inserted right after Last Name -->
        <div class="form-group">
          <label for="role" class="required">Role</label>
          <select id="role" name="role" required>
            <option value="">Select Role</option>
            <option value="User">User</option>
            <option value="Employee">Employee</option>
            <option value="Admin">Admin</option>
          </select>
        </div>

        <div class="form-group">
          <label for="email" class="required">Email Address</label>
          <input type="email" id="email" name="email" required maxlength="254" placeholder="your.email@example.com">
        </div>
        
        <div class="form-group">
          <label for="phone" class="required">Phone Number</label>
          <input type="tel" id="phone" name="phone" 
            required 
            pattern="^(\+91[\-\s]?)?[6-9]\d{9}$" 
            placeholder="+91 9876543210">
          <small class="helper-text">Enter a valid 10-digit Indian mobile number (with or without +91)</small>
        </div>

        <div class="form-group">
          <label for="dateOfBirth" class="required">Date of Birth</label>
          <input type="date" id="dateOfBirth" name="dateOfBirth" required min="1900-01-01" max="2025-12-31">
        </div>

        <div class="form-group">
          <label for="age" class="required">Age</label>
          <input type="number" id="age" name="age" required readonly placeholder="Calculated automatically">
        </div>

        <div class="form-group">
          <label for="address" class="required">Address</label>
          <textarea id="address" name="address" required maxlength="500" placeholder="Complete mailing address"></textarea>
        </div>

        <div class="form-group">
          <label for="photo" class="required">Profile Photo</label>
          <div class="file-upload-container">
            <input type="file" id="photo" name="photo" required accept="image/*" class="file-input">
            <label for="photo" class="file-upload-label">Choose Photo</label>
            <div id="photoPreview" class="photo-preview-placeholder">Photo Preview</div>
          </div>
        </div>

        <div class="form-group">
          <label for="password" class="required">Password</label>
          <div class="password-field">
            <input type="password" id="password" name="password" required minlength="8" maxlength="128" placeholder="Create a strong password">
            <button type="button" id="togglePassword" class="password-toggle">Show</button>
          </div>
        </div>

        <div class="button-group">
          <button type="reset" class="btn-secondary">Reset / Clear Form</button>
          <button type="submit" class="btn-primary">Register / Sign Up</button>
        </div>
      </form>
    </div>

    <div class="login-link"><a href="login1.html">Already have an account? Login here</a></div>
  </div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const passwordInput = document.getElementById("password");
    const togglePassword = document.getElementById("togglePassword");
    const photoInput = document.getElementById("photo");
    const photoPreview = document.getElementById("photoPreview");
    const dobInput = document.getElementById("dateOfBirth");
    const ageInput = document.getElementById("age");
    const registrationForm = document.getElementById("registrationForm");

    // Toggle password visibility
    togglePassword.addEventListener("click", () => {
      const type = passwordInput.type === "password" ? "text" : "password";
      passwordInput.type = type;
      togglePassword.textContent = type === "password" ? "Show" : "Hide";
    });

    // Preview selected photo
    let photoBase64 = "";
    photoInput.addEventListener("change", e => {
      const file = e.target.files[0];
      if (file && file.type.startsWith("image/")) {
        const reader = new FileReader();
        reader.onload = ev => {
          photoPreview.innerHTML = `<img src="${ev.target.result}" alt="Preview">`;
          photoBase64 = ev.target.result; // store as Base64
        };
        reader.readAsDataURL(file);
      } else {
        photoPreview.textContent = "Photo Preview";
        photoBase64 = "";
      }
    });

    // Auto-calculate age from DOB
    dobInput.addEventListener("change", () => {
      const dob = new Date(dobInput.value);
      if (!isNaN(dob.getTime())) {
        const today = new Date();
        let age = today.getFullYear() - dob.getFullYear();
        const m = today.getMonth() - dob.getMonth();
        if (m < 0 || (m === 0 && today.getDate() < dob.getDate())) {
          age--;
        }
        ageInput.value = age >= 0 ? age : "";
      } else {
        ageInput.value = "";
      }
    });

    // Handle form submission
    registrationForm.addEventListener("submit", e => {
      e.preventDefault();

      // Collect values
      const userDetails = {
        firstName: document.getElementById("firstName").value.trim(),
        lastName: document.getElementById("lastName").value.trim(),
        role: document.getElementById("role").value,  // ✅ Role saved here
        email: document.getElementById("email").value.trim(),
        phone: document.getElementById("phone").value.trim(),
        dob: document.getElementById("dateOfBirth").value,
        age: document.getElementById("age").value,
        address: document.getElementById("address").value.trim(),
        photo: photoBase64,
        password: passwordInput.value
      };

      // ✅ Extra validation for phone number
      const phonePattern = /^(\+91[\-\s]?)?[6-9]\d{9}$/;
      if (!phonePattern.test(userDetails.phone)) {
        alert("Please enter a valid Indian mobile number.");
        return;
      }

      if (!userDetails.email || !userDetails.password) {
        alert("Email and Password are required.");
        return;
      }

      if (userDetails.password.length < 8) {
        alert("Password must be at least 8 characters long.");
        return;
      }

      if (!userDetails.role) {
        alert("Please select a role.");
        return;
      }

      // ✅ Get all users from localStorage
      let allUsers = JSON.parse(localStorage.getItem("users")) || [];

      // ✅ Check if email already exists
      const existingUser = allUsers.find(u => u.email === userDetails.email);
      if (existingUser) {
        alert("This email is already registered. Please login instead.");
        return;
      }

      // ✅ Save new user
      allUsers.push(userDetails);
      localStorage.setItem("users", JSON.stringify(allUsers));
      localStorage.setItem("userEmail", email);
      localStorage.setItem("userPassword", password);


      alert("Registration successful! Redirecting to login page.");
      window.location.href = "login1.html"; // redirect to login
    });
  });
</script>

</body>
</html>
